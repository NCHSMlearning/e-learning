<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NCHSM Student Portal</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /*
        * CRITICAL FIX: Only show the active tab content
        */
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }

        /* Set Inter font */
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
        }

        /* Sidebar link styling */
        .nav-link {
            transition: all 0.2s ease-in-out;
            padding: 0.75rem 1rem;
            display: flex;
            align-items: center;
            border-radius: 0.5rem;
        }
        .nav-link:hover {
            background-color: #374151; /* Darker gray on hover */
        }
        .nav-link.active {
            background-color: #10b981; /* Green for active link */
            color: #ffffff;
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div id="app-container" class="flex">

        <!-- Sidebar Navigation -->
        <aside id="sidebar" class="w-64 bg-gray-800 text-gray-200 space-y-6 py-7 px-2 fixed inset-y-0 left-0 transform -translate-x-full lg:relative lg:translate-x-0 transition duration-200 ease-in-out z-50">

            <!-- Sidebar Header -->
            <div class="sidebar-header px-4 flex items-center mb-10">
                <div class="text-3xl font-extrabold text-green-400">
                    &#x1F393; NCHSM
                </div>
                <h2 class="text-xl font-semibold ml-3 text-white">Student</h2>
            </div>

            <!-- Navigation Links -->
            <nav class="flex flex-col space-y-1">
                <a href="#" data-tab="welcome" class="nav-link active">
                    <span class="mr-3">&#x1F3E0;</span>
                    Welcome/Getting Started
                </a>
                <a href="#" data-tab="dashboard" class="nav-link text-gray-400 hover:text-white">
                    <span class="mr-3">&#x1F4C8;</span>
                    Dashboard
                </a>
                <a href="#" data-tab="profile" class="nav-link text-gray-400 hover:text-white">
                    <span class="mr-3">&#x1F464;</span>
                    My Profile
                </a>
                <a href="#" data-tab="grades" class="nav-link text-gray-400 hover:text-white">
                    <span class="mr-3">&#x1F4DD;</span>
                    Grades & Reports
                </a>
                <a href="#" data-tab="attendance" class="nav-link text-gray-400 hover:text-white">
                    <span class="mr-3">&#x23F0;</span>
                    Attendance Logs
                </a>
                <a href="#" data-tab="announcements" class="nav-link text-gray-400 hover:text-white">
                    <span class="mr-3">&#x1F4E3;</span>
                    Announcements
                </a>
                <a href="#" data-tab="messages" class="nav-link text-gray-400 hover:text-white">
                    <span class="mr-3">&#x1F4E8;</span>
                    Message Admin
                </a>
                 <!-- Placeholder Tabs -->
                <a href="#" data-tab="courses" class="nav-link text-gray-400 hover:text-white mt-2">
                    <span class="mr-3">&#x1F4D6;</span>
                    My Enrollment & Courses
                </a>
                <a href="#" data-tab="cats-exams" class="nav-link text-gray-400 hover:text-white mt-2">
                    <span class="mr-3">&#x1F5D2;</span>
                    CATs/Exams
                </a>
                <a href="#" data-tab="academic-calendar" class="nav-link text-gray-400 hover:text-white mt-2">
                    <span class="mr-3">&#x1F4C5;</span>
                    Academic Calendar
                </a>
                <a href="#" data-tab="learning-resources" class="nav-link text-gray-400 hover:text-white mt-2">
                    <span class="mr-3">&#x1F4A1;</span>
                    Learning Resources
                </a>
                <!-- Logout/Spacer -->
                <a href="#" id="logout-link" class="nav-link bg-red-600 hover:bg-red-700 text-white mt-4 justify-center">
                    <span class="mr-2">&#x274C;</span>
                    Logout
                </a>
            </nav>

        </aside>

        <!-- Main Content Area -->
        <div class="flex-1 lg:ml-64">
            
            <!-- Mobile Header/Toggle -->
            <header class="flex justify-between items-center bg-white shadow p-4 lg:hidden sticky top-0 z-40">
                <button id="menu-toggle" class="text-gray-600 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-green-500 rounded-lg p-2 transition duration-150 ease-in-out">
                    <!-- Hamburger Icon -->
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                </button>
                <h1 class="text-xl font-bold text-gray-800">Student Portal</h1>
                <div class="w-6 h-6"></div> <!-- Spacer -->
            </header>

            <main class="p-6 md:p-10">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Welcome, <span id="student-name">Student</span>!</h1>
                <p class="text-lg text-gray-500 mb-8">Your academic resources and tools.</p>

                <!-- 1. Welcome/Getting Started Tab (Active by default) -->
                <section id="welcome" class="tab-content active space-y-6">
                    <!-- Dynamic Welcome/Announcement Message (Placeholder structure) -->
                    <div class="bg-blue-600 text-white p-6 rounded-xl shadow-lg flex items-center gap-4">
                         <span class="text-3xl">&#x1F4E3;</span>
                        <h2 class="text-2xl font-bold" id="welcome-subject">THE OFFICIAL ANNOUNCMENT IS HERE</h2>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-lg space-y-4" id="welcome-body">
                        <!-- Content goes here (Admin-editable text) -->
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Getting Started</h3>
                        <p class="text-gray-700">Use the navigation bar on the left to access your profile, grades, attendance, and communication tools. Please check the Announcements tab regularly for important updates.</p>
                        <p class="text-gray-700">This content is dynamically updated by the Super Admin.</p>
                    </div>
                </section>

                <!-- 2. Dashboard Tab (Includes Geo-Attendance Check) -->
                <section id="dashboard" class="tab-content">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-6">Dashboard Overview & Daily Check-In</h2>

                    <!-- Attendance Check-In Widget -->
                    <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-yellow-500 mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Daily Geo-Attendance Check</h3>
                        <div class="space-y-4">
                            <!-- Step 1: Session Type -->
                            <div>
                                <label for="session-type" class="block text-sm font-medium text-gray-700 mb-1">1. Select Session Type</label>
                                <select id="session-type" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500" required>
                                    <option value="">-- Choose Type --</option>
                                    <option value="on-class">On Class Session</option>
                                    <option value="clinicals">Clinicals Session</option>
                                </select>
                            </div>

                            <!-- Step 2: Session Detail (Conditionally Hidden/Shown by JS) -->
                            <div id="session-detail-container" class="hidden">
                                <label for="session-detail" class="block text-sm font-medium text-gray-700 mb-1">2. Select Lesson/Rotation</label>
                                <select id="session-detail" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500" disabled required>
                                    <!-- Options populated by JS -->
                                </select>
                            </div>

                            <button id="check-in-button" class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-4 rounded-lg transition duration-150 disabled:bg-gray-400 disabled:cursor-not-allowed" disabled>
                                Check In Now
                            </button>
                            <p id="check-in-status" class="text-sm text-gray-600 mt-2 text-center">Please select the session type and detail to enable check-in.</p>
                        </div>
                    </div>

                    <!-- Other Dashboard Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-green-500">
                            <p class="text-sm font-medium text-gray-500">Current GPA</p>
                            <p class="text-3xl font-extrabold text-gray-900 mt-1">3.85</p>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-blue-500">
                            <p class="text-sm font-medium text-gray-500">Attendance Rate</p>
                            <p class="text-3xl font-extrabold text-gray-900 mt-1">94%</p>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-indigo-500">
                            <p class="text-sm font-medium text-gray-500">Unread Messages</p>
                            <p class="text-3xl font-extrabold text-gray-900 mt-1">3</p>
                        </div>
                    </div>
                </section>


                <!-- 3. Profile Tab -->
                <section id="profile" class="tab-content">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4">My Profile</h2>
                    <div class="bg-white p-6 rounded-xl shadow-lg space-y-3">
                        <p><strong>Full Name:</strong> <span class="text-gray-700">Loading...</span></p>
                        <p><strong>Email:</strong> <span class="text-gray-700">Loading...</span></p>
                        <p><strong>Student ID:</strong> <span class="text-gray-700">Loading...</span></p>
                        <p><strong>Program:</strong> <span class="text-gray-700">Loading...</span></p>
                        <p><strong>Phone:</strong> <span class="text-gray-700">Loading...</span></p>
                        <p><strong>Account Status:</strong> <span class="text-green-600 font-semibold">Loading...</span></p>
                    </div>
                </section>

                <!-- 4. Grades & Reports Tab -->
                <section id="grades" class="tab-content">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4">My Grades & Reports</h2>
                    <div class="p-8 border-2 border-dashed border-gray-300 rounded-xl text-center text-gray-500 bg-gray-50">
                        <p class="text-lg">My Grades & Reports</p>
                        <p>This tab is where you would view detailed grades for all modules, and download official academic reports. (Under Construction)</p>
                    </div>
                </section>

                <!-- 5. Attendance Logs Tab -->
                <section id="attendance" class="tab-content">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4">Your Attendance History</h2>
                    <div class="bg-white p-6 rounded-xl shadow-lg overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Check-In Time</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Check-Out Time</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Session</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200" id="attendance-table">
                                <tr><td colspan="5" class="px-6 py-4 text-center text-gray-500">Loading your attendance logs...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>
                
                <!-- 6. Announcements Tab -->
                <section id="announcements" class="tab-content">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4">Program Announcements</h2>
                    <div class="bg-white p-6 rounded-xl shadow-lg space-y-4">
                        <p class="text-gray-500">Important notices sent by the administration regarding your program or the entire university.</p>
                        <p class="text-gray-500">Loading announcements...</p>
                    </div>
                </section>

                <!-- 7. Message Admin Tab -->
                <section id="messages" class="tab-content">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4">Send Message to Administration</h2>
                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <form id="messages-form" class="space-y-4">
                            <textarea id="message-body" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 resize-y" rows="6" placeholder="Use this form to send a private inquiry or report an issue directly to the admin team." required></textarea>
                            <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-150">
                                Send Message
                            </button>
                            <p id="message-status" class="text-sm text-gray-500 mt-2"></p>
                        </form>
                    </div>
                </section>

                <!-- 8. Courses Tab -->
                <section id="courses" class="tab-content">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4">My Enrollment & Courses</h2>
                    <div class="p-8 border-2 border-dashed border-gray-300 rounded-xl text-center text-gray-500 bg-gray-50">
                        <p>This tab would show your full history of enrolled programs and the modules registered for the current term. (Under Construction)</p>
                    </div>
                </section>

                <!-- 9. CATs/Exams Tab -->
                <section id="cats-exams" class="tab-content">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4">CATs/Exams</h2>
                    <div class="p-8 border-2 border-dashed border-gray-300 rounded-xl text-center text-gray-500 bg-gray-50">
                        <p>Schedules and results for CATs and Exams. (Under Construction)</p>
                    </div>
                </section>

                <!-- 10. Academic Calendar Tab -->
                <section id="academic-calendar" class="tab-content">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4">Academic Calendar</h2>
                    <div class="p-8 border-2 border-dashed border-gray-300 rounded-xl text-center text-gray-500 bg-gray-50">
                        <p>University academic calendar. (Under Construction)</p>
                    </div>
                </section>

                <!-- 11. Learning Resources Tab -->
                <section id="learning-resources" class="tab-content">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4">Learning Resources</h2>
                    <div class="p-8 border-2 border-dashed border-gray-300 rounded-xl text-center text-gray-500 bg-gray-50">
                        <p>Links to student resources. (Under Construction)</p>
                    </div>
                </section>
            </main>
        </div>

    </div>

    <!-- Toast Notification / Custom Alert Replacement for Logout -->
    <div id="toast-message" class="fixed bottom-4 right-4 bg-red-600 text-white p-4 rounded-lg shadow-xl transition-opacity duration-300 opacity-0 z-50">
        Logging out... Goodbye!
    </div>
    <!-- /Toast Notification -->

    <script>
        // Data for Attendance Dropdowns
        const courses = [
            "Anatomy & Physiology I", "Medical Microbiology", "Clinical Pharmacology", "Nursing Ethics & Law", 
            "Health Informatics", "Biostatistics"
        ];
        const clinicals = [
            "Maternity Rotation", "Medical Ward", "Surgical Ward Male", "Surgical Ward Female", 
            "Psychiatry Ward", "Paediatric Ward", "Outpatient Department (OPD)"
        ];

        // DOM Elements
        const menuToggle = document.getElementById('menu-toggle');
        const sidebar = document.getElementById('sidebar');
        const navLinks = document.querySelectorAll('.nav-link');
        const tabs = document.querySelectorAll('.tab-content');
        const logoutLink = document.getElementById('logout-link');
        const toastMessage = document.getElementById('toast-message');

        const sessionTypeSelect = document.getElementById('session-type');
        const sessionDetailContainer = document.getElementById('session-detail-container');
        const sessionDetailSelect = document.getElementById('session-detail');
        const checkInButton = document.getElementById('check-in-button');
        const checkInStatus = document.getElementById('check-in-status');

        // --- Core Functions ---

        function toggleSidebar() {
            sidebar.classList.toggle('-translate-x-full');
            const existingOverlay = document.getElementById('sidebar-overlay');
            
            if (!sidebar.classList.contains('-translate-x-full')) {
                if (!existingOverlay) {
                    const overlay = document.createElement('div');
                    overlay.id = 'sidebar-overlay';
                    overlay.classList.add('fixed', 'inset-0', 'bg-gray-900', 'bg-opacity-50', 'z-40', 'lg:hidden');
                    overlay.addEventListener('click', toggleSidebar);
                    document.body.appendChild(overlay);
                }
            } else {
                if (existingOverlay) {
                    existingOverlay.remove();
                }
            }
        }

        function showTab(tabId) {
            tabs.forEach(tab => tab.classList.remove('active'));
            const activeTab = document.getElementById(tabId);
            if(activeTab) activeTab.classList.add('active');

            navLinks.forEach(l => {
                l.classList.remove('active', 'text-white', 'font-semibold');
                if (l.id !== 'logout-link') {
                    l.classList.add('text-gray-400', 'hover:text-white');
                }
            });
            const activeLink = document.querySelector(`.nav-link[data-tab="${tabId}"]`);
            if (activeLink) {
                activeLink.classList.add('active', 'text-white', 'font-semibold');
                activeLink.classList.remove('text-gray-400', 'hover:text-white');
            }
        }

        function showLogoutToast() {
            toastMessage.classList.remove('opacity-0');
            toastMessage.classList.add('opacity-100');
            
            setTimeout(() => {
                toastMessage.classList.remove('opacity-100');
                toastMessage.classList.add('opacity-0');
            }, 2000);
        }

        // --- Attendance Logic ---

        function updateAttendanceDetail(sessionType) {
            sessionDetailSelect.innerHTML = '<option value="">-- Choose Lesson/Rotation --</option>';
            
            if (!sessionType) {
                sessionDetailContainer.classList.add('hidden');
                sessionDetailSelect.setAttribute('disabled', 'true');
                return;
            }

            const optionsData = sessionType === 'on-class' ? courses : clinicals;
            optionsData.forEach(item => {
                const option = document.createElement('option');
                option.value = item;
                option.textContent = item;
                sessionDetailSelect.appendChild(option);
            });

            sessionDetailContainer.classList.remove('hidden');
            sessionDetailSelect.removeAttribute('disabled');
            
            validateAttendanceForm();
        }

        function validateAttendanceForm() {
            const typeSelected = sessionTypeSelect.value !== "";
            const detailSelected = sessionDetailSelect.value !== "";

            if (typeSelected && detailSelected) {
                checkInButton.removeAttribute('disabled');
                checkInButton.classList.remove('disabled:bg-gray-400', 'disabled:cursor-not-allowed');
                checkInStatus.textContent = `Ready to check in for ${sessionDetailSelect.value}.`;
            } else {
                checkInButton.setAttribute('disabled', 'true');
                checkInButton.classList.add('disabled:bg-gray-400', 'disabled:cursor-not-allowed');
                checkInStatus.textContent = "Please select the session type and detail to enable check-in.";
            }
        }

        // --- Event Listeners ---

        menuToggle.addEventListener('click', toggleSidebar);

        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                if (link.id === 'logout-link') return;

                e.preventDefault();
                const tabId = link.getAttribute('data-tab');
                if (tabId) {
                    showTab(tabId);
                }

                if (window.innerWidth < 1024 && !sidebar.classList.contains('-translate-x-full')) {
                    toggleSidebar();
                }
            });
        });

        logoutLink.addEventListener('click', (e) => {
            e.preventDefault();
            showLogoutToast();
            if (window.innerWidth < 1024 && !sidebar.classList.contains('-translate-x-full')) {
                toggleSidebar();
            }
        });

        // Attendance Form Listeners
        sessionTypeSelect.addEventListener('change', (e) => {
            updateAttendanceDetail(e.target.value);
        });

        sessionDetailSelect.addEventListener('change', validateAttendanceForm);

        checkInButton.addEventListener('click', (e) => {
            e.preventDefault();
            if (checkInButton.disabled) return;

            const sessionType = sessionTypeSelect.value === 'on-class' ? 'Class' : 'Clinical';
            const sessionDetail = sessionDetailSelect.value;
            const currentTime = new Date().toLocaleTimeString();
            
            // In a real application, geolocation and API call would happen here.
            checkInStatus.textContent = `Check-In successful! Logged for ${sessionType}: ${sessionDetail} at ${currentTime}.`;
        });

        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => {
            showTab('welcome');
            document.getElementById('student-name').textContent = 'Jane Doe'; 
        });
    </script>
</body>
</html>
